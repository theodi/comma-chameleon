<!DOCTYPE html>
<html>
  <head>
    <title>Untitled.csv</title>
    <script>
    window.$ = window.jQuery = require('./bower_components/jquery/dist/jquery.js');
    </script>
    <link rel="stylesheet" href="bower_components/handsontable/dist/handsontable.full.css" />
    <script src="bower_components/handsontable/dist/handsontable.full.js"></script>
    <script src="bower_components/jquery-csv/src/jquery.csv.min.js"></script>
    <style type="text/css">
      body, html {
        margin: 0;
        padding: 0;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }
    </style>
  </head>
  <body>
    <div id="editor"></div>
    <script>
    var ipc = require('ipc');
    var fs = require('fs');
    var container = document.getElementById("editor");
    var hot = new Handsontable(container, {
      colHeaders: true,
      rowHeaders: true,
      columnSorting: true,
      contextMenu: true
    });

    ipc.on('loadData', function(data) {

      csv = $.csv.toArrays(data);
      hot.loadData(csv);
    });

    ipc.on('saveData', function(fileName) {
      data = hot.getData().map(function(d) { return d.join(",") }).join("\n");
      fs.writeFile(fileName, data, function (err) {
      });
      document.title = fileName;
    });

    </script>
  </body>
</html>
